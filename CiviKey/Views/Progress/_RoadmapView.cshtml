@model CiviKey.ViewModel.RoadmapViewModel
@{
@*Feature display part*@
    <div class="progress-list-of-features" data-id="@ViewBag.CurrentRoadmapId">
        @if( Model.Sponsors.Count > 0 )
        {
            <div class="roadmap-sponsors-div">
                <div class="road-map-sponsors-title">
                    <p> 
                        Entités participant à cette roadmap : 
                    </p>
                </div>
                <div style="padding-top:5px; padding-bottom:10px;width:100%; margin-left: 10px; margin-right:10px;">
                    @foreach( var participation in Model.Sponsors )
                    {
                            <img src="@Url.Content("~/Content/images/PartnerLogo/small/" + participation.ContactRelation.Contact.LogoPath)" style="height: 32px; " alt="logo-@participation.ContactRelation.Contact.Name" title="@participation.ContactRelation.Contact.Name" />
                            <span>@participation.ContactRelation.Contact.Name</span>
                    }
                </div>
                <div style="clear: both;"></div>
            </div>
        }
        <div class="accordion" id="accordion2">
            @if( Model.NewFeatures.Count > 0 )
            {
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <div class="collapse-image colapsed"></div>
                        <img class="category-img" src="@Url.Content( "~/Content/images/CategoryIcon/add_24x24.png" )" alt="nouvelles fonctionnalités" />
                        <h2 class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseOne">
                            Nouvelles fonctionnalités (@Model.NewFeatures.Count)
                        </h2>
                    </div>
                    <div id="collapseOne" class="accordion-body collapse">
                        <div class="accordion-inner">
                            @Html.Partial( "_FeatureCategoryView", Model.NewFeatures )
                        </div>
                    </div>
                </div>
            }
            @if( Model.UpdatedFeatures.Count > 0 )
            {
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <div class="collapse-image colapsed"></div>
                        <img class="category-img" src="@Url.Content( "~/Content/images/CategoryIcon/up_arrow_24x24.png" )" alt="fonctionnalités améliorées" />
                        <h2 class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseTwo">
                            Fonctionnalités améliorées (@Model.UpdatedFeatures.Count)
                        </h2>
                    </div>
                    <div id="collapseTwo" class="accordion-body collapse">
                        <div class="accordion-inner">
                            @Html.Partial( "_FeatureCategoryView", Model.UpdatedFeatures )
                        </div>
                    </div>
                </div>
            }
            @if( Model.AvailableFeatures.Count > 0 )
            {
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <div class="collapse-image colapsed"></div>
                        <img class="category-img" src="@Url.Content( "~/Content/images/CategoryIcon/check_mark_24x24.png" )" alt="fonctionnalités portées sur cette version" />
                        <h2 class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseThree">
                            Fonctionnalités disponibles (@Model.AvailableFeatures.Count)
                        </h2>
                    </div>
                    <div id="collapseThree" class="accordion-body collapse">
                        <div class="accordion-inner">
                            @Html.Partial( "_FeatureCategoryView", Model.AvailableFeatures )
                        </div>
                    </div>
                </div>
            }
            @if( Model.UnavailableFeatures.Count > 0 )
            {
                <div class="accordion-group">
                    <div class="accordion-heading">
                        <div class="collapse-image colapsed">
                        </div>
                        <img class="category-img" src="@Url.Content( "~/Content/images/CategoryIcon/delete_24x24.png" )" alt="fonctionnalités supprimées"/>
                        <h2 class="accordion-toggle" data-toggle="collapse" data-parent="#accordion2" href="#collapseFour">
                            Fonctionnalités non disponibles (@Model.UnavailableFeatures.Count)
                        </h2>
                    </div>
                    <div id="collapseFour" class="accordion-body collapse">
                        <div class="accordion-inner">
                            @Html.Partial( "_FeatureCategoryView", Model.AvailableFeatures )
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>
    <div class="release-info-main-container">
        <div class="mode-toggle-container release-info-container">
            <p>
                Changer de vue
            </p>
            <a href="#" title="Classer par type d'aide" id="mode-toggle-category" class="mode-toggle-img" rel="byHelpType">&nbsp;</a>
        </div>
    </div>
}
<script type="text/javascript">
    (function () {
        $("#mode-toggle-category").click(function () {
            $("[rel=byHelpType]").tooltip('hide');
            $.get('@Html.Raw(Url.RouteUrl( new {action = "GetFeatureView", controller = "Progress", version = @Model.Name, type="categorized"}))', function (data) {
                $("#featureList").html(data);
                document.CK.AjaxCallbacks.onProgressCategoryChangeSuccess("categorized");
            })
        });

        $(".collapse").collapse({ toggle: false });


        $("[rel=byHelpType]").tooltip({ 'placement': 'right', 'trigger': 'hover' });
    } ())
</script>
